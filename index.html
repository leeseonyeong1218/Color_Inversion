<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Color_inversion</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jim+Nightshade&display=swap"
      rel="stylesheet"
    />

    <style>
      @font-face {
        font-family: "MapoGeumbitnaru";
        src: url("https://gcore.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/MapoGoldenPierA.woff")
          format("woff");
        font-weight: normal;
        font-display: swap;
      }

      :root {
        --bg-color: #000000;
        --text-color: #ffffff;
        --accent-color: #5f1010;
        
        /* 라인 색상 */
        --line-red: #ff0006;
        --line-blue: #1a3b9e;
        
        --lens-size: 200px;
      }
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: "MapoGeumbitnaru", serif;
        overflow-x: hidden;
        min-height: 100vh;
        cursor: default;
        position: relative;
      }

      /* === INTRO SECTION === */
      #intro-section {
        height: 100vh;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 10;
        background-color: #000;
      }

      header {
        position: absolute;
        top: 2rem;
        text-align: center;
        width: 100%;
        z-index: 10;
        pointer-events: none;
      }
      h1 {
        font-family: "Jim Nightshade", cursive;
        font-size: 4rem;
        font-weight: 400;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        margin-bottom: 0.5rem;
        opacity: 0.9;
        color: #d8d8d8;
      }
      p.subtitle {
        font-family: "MapoGeumbitnaru", serif;
        font-size: 1rem;
        color: #888;
        letter-spacing: 0.1em;
        margin-top: -10px;
      }

      .gallery-container {
        display: flex;
        gap: 2rem;
        align-items: center;
        justify-content: center;
        width: 100%;
        padding: 2rem;
        perspective: 1000px;
      }
      .card-wrapper {
        position: relative;
        width: 22vw;
        max-width: 280px;
        aspect-ratio: 9 / 16;
        border-radius: 8px;
        overflow: hidden;
        background-color: #111;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        opacity: 0;
        transform: translateY(100px) rotate(0deg);
        animation: cardFanIn 1.2s cubic-bezier(0.25, 1, 0.5, 1) forwards;
      }
      @keyframes cardFanIn {
        0% { opacity: 0; transform: translateY(100px) scale(0.9) rotate(var(--rot-start)); }
        60% { opacity: 1; transform: translateY(-20px) scale(1.05) rotate(var(--rot-mid)); }
        100% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
      }
      .card-wrapper:nth-child(1) { --rot-start: -15deg; --rot-mid: -5deg; animation-delay: 0.1s; }
      .card-wrapper:nth-child(2) { --rot-start: -5deg; --rot-mid: -2deg; animation-delay: 0.2s; }
      .card-wrapper:nth-child(3) { --rot-start: 5deg; --rot-mid: 2deg; animation-delay: 0.3s; }
      .card-wrapper:nth-child(4) { --rot-start: 15deg; --rot-mid: 5deg; animation-delay: 0.4s; }
      
      .card-image {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        object-fit: cover; pointer-events: none;
        z-index: 1;
        transform: scale(1.02);
        transform-origin: center;
      }
      .card-video {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        object-fit: cover; pointer-events: none;
        z-index: 2; opacity: 1;
        clip-path: circle(0px at 50% 50%);
        filter: contrast(1.2) brightness(1.1);
      }
      video::-webkit-media-controls { display: none !important; }

      .controls {
        position: absolute; bottom: 3rem; z-index: 50;
      }
      .btn-toggle {
        width: 60px; height: 60px; border-radius: 50%;
        background-color: transparent; border: 2px solid var(--accent-color);
        cursor: pointer; transition: all 0.3s ease;
        display: flex; align-items: center; justify-content: center;
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.2);
      }
      .btn-toggle:hover { background-color: var(--accent-color); }
      .btn-inner {
        width: 20px; height: 20px; background-color: var(--accent-color);
        border-radius: 50%; transition: transform 0.3s;
      }
      .btn-toggle:hover .btn-inner { background-color: #000; transform: scale(1.2); }
      .btn-toggle.active { background-color: var(--accent-color); }
      .btn-toggle.active .btn-inner { background-color: #000; }
      .btn-label {
        position: absolute; bottom: -40px; left: 50%; transform: translateX(-50%);
        font-family: "Jim Nightshade", cursive; font-size: 1.5rem;
        letter-spacing: 0.1em; color: #888; white-space: nowrap;
        opacity: 0; transition: opacity 0.3s;
      }
      .controls:hover .btn-label { opacity: 1; }

      /* === SVG PATH BACKGROUND === */
      #path-container {
        position: absolute;
        top: 100vh;
        left: 0;
        width: 100%;
        height: 400vh; /* 스토리 섹션 높이 */
        z-index: 1;
        pointer-events: none;
        overflow: visible;

        -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 5%);
        mask-image: linear-gradient(to bottom, transparent 0%, black 5%);
      }
      
      #scrollPath {
        width: 100%;
        height: 100%;
        overflow: visible;
      }

      /* 라인 스타일 */
      .cls-1 { stroke: var(--line-red); }
      .cls-2 { stroke: var(--line-blue); }
      .cls-1, .cls-2 { 
        fill: none; 
        stroke-miterlimit: 10; 
        stroke-width: 2.5px;
        stroke-linecap: round;
        stroke-linejoin: round;
        opacity: 0.6;
      }

      /* === [NEW] GLOBAL RED DOT === */
      /* SVG 밖으로 빼서 Z-index 문제를 완벽히 해결 */
      #global-dot {
        position: absolute;
        /* Intro(100vh) + Path(400vh) = 500vh 끝점 */
        top: 500vh; 
        left: 50%;
        width: 10px;  /* 반지름 5px * 2 */
        height: 10px;
        background-color: #ff0006;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        
        /* 가장 중요한 부분: 모든 요소 위에 오도록 설정 */
        z-index: 9999; 
        
        opacity: 0;
        transition: opacity 0.5s ease;
        box-shadow: 0 0 10px rgba(255, 0, 6, 0.6); /* 약간의 빛나는 효과 */
        pointer-events: none;
      }
      #global-dot.visible {
        opacity: 1;
      }

      /* === STORY LAYOUT === */
      .story-section {
        width: 100%;
        height: 100vh;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        border: none;
        background-color: transparent; 
        z-index: 5; 
      }

      .story-grid {
        display: grid;
        grid-template-columns: 1fr 300px 1fr;
        width: 90%;
        max-width: 1200px;
        height: 80%;
        align-items: center;
        position: relative;
      }

      .text-group {
        display: flex;
        flex-direction: column;
        justify-content: center;
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 1s ease, transform 1s ease;
        max-width: 300px;
      }

      .story-section.visible .text-group {
        opacity: 1;
        transform: translateY(0);
      }

      .text-top-left {
        align-self: start;
        align-items: flex-end;
        text-align: right;
        padding-right: 1rem;
        margin-top: 5rem;
        margin-left: auto;
      }

      .text-bottom-right {
        align-self: end;
        align-items: flex-start;
        text-align: left;
        padding-left: 1rem;
        margin-bottom: 5rem;
        margin-right: auto;
      }

      .story-title {
        font-family: "Jim Nightshade", cursive;
        font-size: 2.5rem;
        color: #fff;
        line-height: 1;
        margin: 0;
        margin-bottom: 5px;
      }

      .separator-line {
        width: 100%;
        height: 1px;
        background-color: #fff;
        margin-bottom: 1rem;
        opacity: 0.7;
      }

      .story-subtitle {
        font-size: 0.9rem;
        color: #bbb;
        margin-bottom: 1rem;
        font-weight: normal;
        letter-spacing: 0.05em;
      }

      .story-desc {
        font-size: 0.85rem;
        line-height: 1.7;
        color: #ddd;
        white-space: pre-line;
      }

      /* 카드 스택 영역 */
      .card-stack {
        position: relative;
        width: 100%;
        height: 450px;
        display: flex;
        justify-content: center;
        align-items: center;
        perspective: 1000px;
        cursor: pointer;
      }

      .story-card {
        position: absolute;
        width: 240px;
        height: 400px;
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
        border: 1px solid #333;
        overflow: hidden;
        transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), z-index 0s, filter 0.6s;
        background: #000;
      }

      .story-card img, .story-card video {
        width: 100%; height: 100%; object-fit: cover;
      }

      /* === 상태별 카드 스타일 === */
      .story-section[data-mode="red"] .card-red {
        z-index: 10; transform: rotate(-3deg) scale(1); filter: brightness(1);
      }
      .story-section[data-mode="red"] .card-blue {
        z-index: 5; transform: rotate(3deg) translate(20px, 20px) scale(0.95); filter: brightness(0.4);
      }

      .story-section[data-mode="blue"] .card-red {
        z-index: 5; transform: rotate(-3deg) translate(-20px, 20px) scale(0.95); filter: brightness(0.4);
      }
      .story-section[data-mode="blue"] .card-blue {
        z-index: 10; transform: rotate(3deg) scale(1); filter: brightness(1);
      }

      /* === CONCLUSION SECTION (결론 텍스트) === */
      #conclusion-section {
        width: 100%;
        min-height: 50vh;
        position: relative;
        z-index: 10;
        background-color: transparent; 
        text-align: center;
        
        /* 점과 텍스트 사이 간격 (80px) */
        padding-top: 80px; 
        padding-bottom: 20vh;
      }
      
      .conclusion-text p {
        font-size: 1.1rem;
        line-height: 2.6;
        color: #fff;
        margin-bottom: 0.5rem;
        font-weight: 300;
        letter-spacing: 0.05em;
        
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 1.2s ease, transform 1.2s ease;
      }

      /* 순차적 등장 */
      .conclusion-text.visible p:nth-child(1) {
        opacity: 1; transform: translateY(0);
        transition-delay: 0.5s;
      }
      .conclusion-text.visible p:nth-child(2) {
        opacity: 1; transform: translateY(0);
        transition-delay: 1.8s;
      }
      .conclusion-text.visible p:nth-child(3) {
        opacity: 1; transform: translateY(0);
        transition-delay: 3.5s;
      }

      /* 하단 MAIN 링크 스타일 */
      .footer-link-container {
        width: 100%;
        height: 30vh;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
        z-index: 20;
      }
      .main-link {
        font-family: "Jim Nightshade", cursive;
        font-size: 1.25rem; /* 2.5rem -> 1.25rem (2배 축소) */
        color: #555;
        text-decoration: none;
        letter-spacing: 0.2em;
        transition: all 0.4s ease;
        opacity: 0.8;
      }
      .main-link:hover {
        color: #ffffff; /* 빨강 -> 흰색 */
        transform: scale(1.1);
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5); /* 그림자도 흰색으로 변경 */
        opacity: 1;
      }

      /* 렌즈 효과 */
      #lens {
        position: fixed; top: 0; left: 0;
        width: var(--lens-size); height: var(--lens-size);
        border-radius: 50%;
        background-color: rgba(255, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.3);
        pointer-events: none;
        z-index: 9999;
        transform: translate(-50%, -50%);
        display: none;
        box-shadow: 0 0 30px rgba(255, 0, 0, 0.3);
        backdrop-filter: contrast(1.2);
      }
      body.filter-active { cursor: none; }

      @media (max-width: 900px) {
        .story-grid {
          grid-template-columns: 1fr;
          grid-template-rows: auto auto auto;
          gap: 1rem;
        }
        .text-group {
          align-self: center; align-items: center; text-align: center;
          padding: 0; margin: 0; max-width: 100%;
        }
        .story-desc { text-align: center; }
        .text-top-left { order: 1; }
        .card-stack { order: 2; height: 350px; margin: 1rem 0; }
        .text-bottom-right { order: 3; margin-bottom: 3rem; }
        .story-card { width: 180px; height: 300px; }
        #path-container { height: 400vh; } 
      }
    </style>
  </head>
  <body>
    <div id="intro-section">
      <header>
        <h1>RED</h1>
        <p class="subtitle">붉은색을 걷어내고, 다른 의미를 확인하세요.</p>
      </header>

      <div class="gallery-container" id="gallery"></div>

      <div class="controls">
        <button class="btn-toggle" id="filterBtn" onclick="app.toggleFilter()">
          <div class="btn-inner"></div>
        </button>
        <span class="btn-label">click</span>
      </div>
    </div>

    <div id="path-container">
      <svg id="scrollPath" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1517.93 5194.74" preserveAspectRatio="none">
        <path class="cls-1 scroll-draw" d="M127,27.51S1,324.51,1,513.51c0,243,576,630,810,720s567,288,630,486c45.74,143.77-63,378-189,549-60.87,82.61-275.1,327.26-351,414-126,144-432,477-495,567s-180.43,250.23-171,468c9.98,230.47,189,405,315,540s180,243,180,351 Q 758.96 4800 758.96 5000 L 758.96 5194.74"/>
        <path class="cls-2 scroll-draw" d="M307,.51S23.57,475.74,109,747.51c73.76,234.66,252,378,396,459s405,153,585,207,351,225,378,270,116.05,196.31-45,504c-163.43,312.23-537.61,505.14-719.43,642.23-41.92,31.61-362.4,297.4-495.57,482.77-152.64,212.48-163.37,331.85-135,486,28.57,155.23,135,270,216,351s225,189,342,279,153,180,144,234-45,99-54,117-9,27-9,36,18,18,18,27"/>
      </svg>
    </div>

    <div id="global-dot"></div>

    <section class="story-section" id="story-1" data-mode="red"></section>
    <section class="story-section" id="story-2" data-mode="red"></section>
    <section class="story-section" id="story-3" data-mode="red"></section>
    <section class="story-section" id="story-4" data-mode="red"></section>

    <section id="conclusion-section">
      <div class="conclusion-text">
        <p>우리는 익숙한 색을 의심하지 않는다.</p>
        <p>색에 붙은 의미는 자연스럽게 받아들여진다.</p>
        <p>하지만 다른 시야로 보면, 같은 장면은 다른 이야기가 된다.</p>
      </div>
    </section>

    <div class="footer-link-container">
      <a href="https://wonwonwonwonwon.github.io/color-/" class="main-link">Color:</a>
    </div>

    <audio id="bgMusic" src="BB.mp3" loop preload="auto"></audio>
    <div id="lens"></div>

    <script>
      const CARDS_DATA = [
        { id: 1, img: "https://i.imgur.com/zG3QQuT.jpeg", video: "https://i.imgur.com/R2MeP9z.mp4" },
        { id: 2, img: "https://i.imgur.com/ZyAPfsT.jpeg", video: "https://i.imgur.com/s82Iwbs.mp4" },
        { id: 3, img: "https://i.imgur.com/LCi6XIE.jpeg", video: "https://i.imgur.com/gaLJMWZ.mp4" },
        { id: 4, img: "https://i.imgur.com/P6N7ywS.jpeg", video: "https://i.imgur.com/q4rOKBO.mp4" },
      ];

      const STORY_DATA = [
        {
          id: 1,
          img: "https://i.imgur.com/zz1vqrn.jpeg",
          video: "https://i.imgur.com/R2MeP9z.mp4",
          front: {
            title: "WARBRINGER",
            subtitle: "전쟁의 영웅",
            desc: "고대 로마의 전쟁신 마르스를 비롯해, 붉은색은 전쟁 깃발·군복·훈장 등 군사 상징에 반복적으로 사용되어 왔다. 피와 생명을 연상시키는 색은 용기와 공격성, 국가를 위한 희생을 시각적으로 정당화했다.\n\n의미: 영웅, 희생, 승리",
          },
          back: {
            title: "AFTERMATH",
            subtitle: "전쟁의 상처",
            desc: "전쟁의 서사는 영웅으로 시작되지만, 끝에 남는 것은 민간인의 죽음과 파괴된 도시, 사회에 남은 회복 불가능한 상흔이다.\n\n의미: 죽음, 파괴, 결과",
          },
        },
        {
          id: 2,
          img: "https://i.imgur.com/XGsZB45.jpeg",
          video: "https://i.imgur.com/s82Iwbs.mp4",
          front: {
            title: "BRIDE OF LIFE",
            subtitle: "혼례의 붉음",
            desc: "인도·네팔 전통 결혼식에서 붉은 사리와 장신구는 생명과 다산, 공동체의 축복을 상징한다. 붉은색은 결혼을 개인의 선택이 아닌 사회적 의례로 고정해왔다.\n\n의미: 생명, 축복, 결합",
          },
          back: {
            title: "MARRIAGE MARKET",
            subtitle: "거래되는 가치",
            desc: "붉은 혼례복은 생명과 축복의 상징으로 소비되지만, 동시에 지참금 제도와 매매혼 구조를 가린다. 결혼은 감정의 결합이 아니라, 여성의 가치가 교환되는 사회적 계약으로 작동해왔다.\n\n의미: 교환, 가격, 구조",
          },
        },
        {
          id: 3,
          img: "https://i.imgur.com/ApS1EOU.jpeg",
          video: "https://i.imgur.com/gaLJMWZ.mp4",
          front: {
            title: "SOVEREIGNTY",
            subtitle: "혁명의 깃발",
            desc: "근대 사회주의·공산주의 운동에서 붉은 깃발은 저항과 해방, 집단적 연대를 상징했다. 색은 변화를 향한 열망을 시각화했다.\n\n의미: 저항, 연대, 해방",
          },
          back: {
            title: "EXCLUSION",
            subtitle: "혁명의 정당화",
            desc: "혁명의 상징은 내부의 적을 가려내는 기준으로 쓰이기도 했다. 해방의 언어는 폭력과 숙청을 정당화했다.\n\n의미: 폭력, 숙청, 정당화",
          },
        },
        {
          id: 4,
          img: "https://i.imgur.com/ETE0F4G.jpeg",
          video: "https://i.imgur.com/q4rOKBO.mp4",
          front: {
            title: "UPRISING",
            subtitle: "권력의 색",
            desc: "로마와 중세 유럽에서 붉은 염료는 왕족과 지배계층만 사용할 수 있었다. 붉은 옷은 정치적 권력과 위계를 시각적으로 고정했다.\n\n의미: 권위, 지배, 위계",
          },
          back: {
            title: "PURGE",
            subtitle: "접근의 제한",
            desc: "붉은 권위의 색은 입을 수 있는 자와 없는 자를 구분했다. 색은 권력을 드러내는 동시에 배제의 기준이 되었다.\n\n의미: 배제, 경계, 통제",
          },
        },
      ];

      const app = {
        isActive: false,
        lensSize: 200,

        init: function () {
          this.renderIntroCards();
          this.renderStorySections();
          this.setupMouseTracking();
          this.initMusic();
          this.setupScrollObserver();
          this.initPathDrawing();
        },

        renderIntroCards: function () {
          const container = document.getElementById("gallery");
          let html = "";
          CARDS_DATA.forEach((card) => {
            html += `
              <div class="card-wrapper" id="card-${card.id}">
                  <img src="${card.img}" class="card-image" alt="Card ${card.id}">
                  <video src="${card.video}" class="card-video" loop muted playsinline webkit-playsinline></video>
              </div>
            `;
          });
          container.innerHTML = html;
        },

        renderStorySections: function () {
          STORY_DATA.forEach((story) => {
            const section = document.getElementById(`story-${story.id}`);
            section.innerHTML = `
              <div class="story-grid">
                <div class="text-group text-top-left">
                  <h2 class="story-title">${story.front.title}</h2>
                  <div class="separator-line"></div>
                  <h3 class="story-subtitle">${story.front.subtitle}</h3>
                  <p class="story-desc">${story.front.desc}</p>
                </div>
                <div class="card-stack" onclick="app.toggleStoryMode(${story.id})">
                  <div class="story-card card-red">
                    <img src="${story.img}" alt="Image ${story.id}">
                  </div>
                  <div class="story-card card-blue">
                    <video src="${story.video}" loop muted autoplay playsinline></video>
                  </div>
                </div>
                <div class="text-group text-bottom-right">
                  <h2 class="story-title">${story.back.title}</h2>
                  <div class="separator-line"></div>
                  <h3 class="story-subtitle">${story.back.subtitle}</h3>
                  <p class="story-desc">${story.back.desc}</p>
                </div>
              </div>
            `;
          });
        },

        setupScrollObserver: function () {
          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  entry.target.classList.add("visible");
                }
              });
            },
            { threshold: 0.3 }
          );

          document.querySelectorAll(".story-section").forEach((section) => {
            observer.observe(section);
          });
          
          const conclusionObs = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  entry.target.querySelector('.conclusion-text').classList.add("visible");
                }
              });
            }, { threshold: 0.2 }
          );
          
          const concSection = document.getElementById("conclusion-section");
          if(concSection) conclusionObs.observe(concSection);
        },

        initPathDrawing: function() {
          const paths = document.querySelectorAll('.scroll-draw');
          
          paths.forEach(path => {
            const length = path.getTotalLength();
            path.style.strokeDasharray = length;
            path.style.strokeDashoffset = length;
          });

          window.addEventListener('scroll', () => {
            this.updatePathDrawing(paths);
          });
          
          this.updatePathDrawing(paths);
        },

        updatePathDrawing: function(paths) {
          const startTrigger = window.innerHeight; 
          const scrollHeight = document.body.scrollHeight - window.innerHeight;
          const scrollTop = window.scrollY;
          
          // 라인 드로잉 길이: 400vh
          const drawSectionHeight = window.innerHeight * 4; 
          
          const currentProgress = scrollTop - startTrigger;
          const scrollBuffer = window.innerHeight * 0.5;

          let progress = (currentProgress + scrollBuffer) / drawSectionHeight;
          
          if (progress < 0) progress = 0;
          if (progress > 1) progress = 1;

          paths.forEach(path => {
            const length = path.getTotalLength();
            const drawLength = length * progress;
            path.style.strokeDashoffset = length - drawLength;
          });

          // SVG 밖의 점(#global-dot) 제어
          const dot = document.getElementById('global-dot');
          if(progress >= 0.99) {
            dot.classList.add('visible');
          } else {
            dot.classList.remove('visible');
          }
        },

        toggleStoryMode: function (id) {
          const section = document.getElementById(`story-${id}`);
          const currentMode = section.getAttribute("data-mode");
          section.setAttribute(
            "data-mode",
            currentMode === "red" ? "blue" : "red"
          );
        },

        initMusic: function () {
          const audio = document.getElementById("bgMusic");
          audio.volume = 0.5;
          const playPromise = audio.play();
          if (playPromise !== undefined) {
            playPromise.catch((error) => {
              document.addEventListener("click", () => { audio.play(); }, { once: true });
            });
          }
        },

        forcePlayVideos: function () {
          const videos = document.querySelectorAll("#intro-section video");
          videos.forEach((vid) => {
            vid.muted = true;
            vid.play().catch((e) => {});
          });
        },

        toggleFilter: function () {
          this.isActive = !this.isActive;
          const btn = document.getElementById("filterBtn");
          const lens = document.getElementById("lens");
          const body = document.body;

          if (this.isActive) {
            btn.classList.add("active");
            lens.style.display = "block";
            body.classList.add("filter-active");
            this.forcePlayVideos();
          } else {
            btn.classList.remove("active");
            lens.style.display = "none";
            body.classList.remove("filter-active");
            document.querySelectorAll("#intro-section .card-video").forEach((video) => {
                video.style.clipPath = `circle(0px at 0 0)`;
              });
          }
        },

        setupMouseTracking: function () {
          document.addEventListener("mousemove", (e) => {
            if (!this.isActive) return;
            const mx = e.clientX;
            const my = e.clientY;
            const lens = document.getElementById("lens");
            lens.style.left = mx + "px";
            lens.style.top = my + "px";

            const cards = document.querySelectorAll("#intro-section .card-wrapper");
            const radius = this.lensSize / 2;
            cards.forEach((card) => {
              const rect = card.getBoundingClientRect();
              const video = card.querySelector(".card-video");
              if (rect.top < window.innerHeight && rect.bottom > 0) {
                const localX = mx - rect.left;
                const localY = my - rect.top;
                video.style.clipPath = `circle(${radius}px at ${localX}px ${localY}px)`;
              }
            });
          });
        },
      };

      window.onload = function () {
        // 브라우저가 스크롤 위치를 기억하지 못하게 하고 맨 위로 강제 이동
        if (history.scrollRestoration) {
          history.scrollRestoration = "manual";
        }
        window.scrollTo(0, 0);
        
        app.init();
      };
    </script>
  </body>
</html>
